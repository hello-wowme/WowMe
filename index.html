<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harmonia</title>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* --- CSS: ãƒ‡ã‚¶ã‚¤ãƒ³è¨­å®š --- */
        :root {
            --bg-color: #e8f5e9; /* è–„ã„ãƒŸãƒ³ãƒˆã‚°ãƒªãƒ¼ãƒ³ï¼ˆè‡ªç„¶ï¼‰ */
            --accent-color: #81c784; /* å°‘ã—æ¿ƒã„ã‚°ãƒªãƒ¼ãƒ³ */
            --text-color: #445544; /* å„ªã—ã„æ·±ç·‘ */
            --card-bg: #ffffff;
            --bird-color: #81d4fa; /* ç©ºã®é’ */
        }

        body {
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            line-height: 1.6;
            background-image: 
                radial-gradient(#fff 10%, transparent 10%),
                radial-gradient(#fff 10%, transparent 10%);
            background-size: 50px 50px;
            background-position: 0 0, 25px 25px;
            background-attachment: fixed; /* ãƒ‰ãƒƒãƒˆæŸ„ã‚’å°‘ã—å…¥ã‚Œã‚‹ */
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header {
            text-align: center;
            padding: 2rem 1rem;
            position: relative;
        }

        .header-icon {
            font-size: 3rem;
            color: var(--text-color);
            margin-bottom: 10px;
            display: block;
        }

        h1 {
            font-size: 1.5rem;
            margin: 0;
            color: var(--text-color);
        }

        .subtitle {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 5px;
        }

        /* ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒ¡ã‚¤ãƒ³ç”»åƒï¼‰ */
        .hero {
            max-width: 800px;
            margin: 0 auto 2rem;
            padding: 0 1rem;
            text-align: center;
            position: relative;
        }

        .hero img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            filter: brightness(0.95);
        }

        .hero-text {
            margin-top: 1rem;
            font-weight: bold;
            color: var(--text-color);
        }

        /* è£…é£¾ï¼ˆé³¥ã‚„æ˜Ÿï¼‰ */
        .deco {
            position: absolute;
            font-size: 1.5rem;
            opacity: 0.7;
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

        /* æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ ã‚¨ãƒªã‚¢ */
        .post-section {
            max-width: 600px;
            margin: 20px auto;
            background: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            width: 90%;
        }

        .post-section h3 {
            text-align: center;
            margin-top: 0;
            color: var(--accent-color);
        }

        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 0.9rem; margin-bottom: 5px; }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #eee;
            border-radius: 10px;
            font-family: inherit;
            box-sizing: border-box;
        }
        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--accent-color);
        }

        button.submit-btn {
            width: 100%;
            padding: 12px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.3s;
        }
        button.submit-btn:hover { background-color: #66bb6a; }

        /* æ›²ãƒªã‚¹ãƒˆã‚¨ãƒªã‚¢ */
        .playlist-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        .section-title {
            text-align: center;
            font-size: 1.3rem;
            margin-bottom: 20px;
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .section-title::before, .section-title::after {
            content: "ğŸ•Šï¸";
            margin: 0 10px;
            font-size: 1.2rem;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        /* ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ */
        .card {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: transform 0.2s;
            display: flex;
            flex-direction: column;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-iframe-container {
            width: 100%;
            height: 152px; /* Spotify Embed Compact height */
            background: #eee;
        }

        .card-content {
            padding: 15px;
            flex-grow: 1;
        }

        .card-title {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .card-artist {
            font-size: 0.9rem;
            color: #777;
            margin-bottom: 10px;
        }

        .card-comment {
            font-size: 0.9rem;
            color: #555;
            background: #f9fbe7;
            padding: 10px;
            border-radius: 8px;
            line-height: 1.5;
        }

        footer {
            text-align: center;
            padding: 40px 20px;
            font-size: 0.9rem;
            color: #666;
            background: rgba(255,255,255,0.5);
            margin-top: 40px;
        }

        /* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
        @media (max-width: 600px) {
            .grid {
                grid-template-columns: 1fr; /* 1åˆ—ã«ã™ã‚‹ */
            }
            .hero img {
                height: 200px;
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-icon">ğŸ§</div>
        <h1>ç§ã®å¸Œæœ›ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆ</h1>
        <div class="subtitle">çµ±åˆå¤±èª¿ç—‡ã¨ã®é—˜ã„ã‚’æ”¯ãˆãŸéŸ³æ¥½ãŸã¡</div>
        <div class="deco" style="top: 20px; left: 10%; font-size: 20px;">âœ¨</div>
        <div class="deco" style="top: 50px; right: 15%; font-size: 24px;">âœ¨</div>
    </header>

    <div class="hero">
        <img src="./assets/images/éŸ³æ¥½ã‚’è´ãå¥³æ€§.jpg" alt="éŸ³æ¥½ã‚’è´ãå¥³æ€§">
        <div class="hero-text">
            ã‚ãªãŸã¯ä¸€äººã˜ã‚ƒãªã„ã€‚<br>
            ã“ã‚Œã‚‰ã®æ­ŒãŒç§ã«å‹‡æ°—ã‚’ä¸ãˆã¦ãã‚ŒãŸã€‚
        </div>
        <div class="deco" style="top: -20px; right: -10px;">ğŸ•Šï¸</div>
    </div>

    <div class="post-section">
        <h3>ã‚ãªãŸã®ã€Œæ”¯ãˆã«ãªã£ãŸæ›²ã€ã‚’æ•™ãˆã¦ãã ã•ã„</h3>
        <form id="songForm">
            <div class="form-group">
                <label>æ›²ã®ã‚¿ã‚¤ãƒˆãƒ«</label>
                <input type="text" id="title" placeholder="ä¾‹: Fight Song" required>
            </div>
            <div class="form-group">
                <label>ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆå</label>
                <input type="text" id="artist" placeholder="ä¾‹: Rachel Platten" required>
            </div>
            <div class="form-group">
                <label>Spotifyã®æ›²ã®URL</label>
                <input type="url" id="url" placeholder="Spotifyã®ã€Œæ›²ã®ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã€ã—ã¦è²¼ä»˜ã‘" required>
                <small style="color:#888; font-size:0.8em;">ä¾‹: https://open.spotify.com/track/...</small>
            </div>
            <div class="form-group">
                <label>ã²ã¨ã“ã¨ãƒ»æ€ã„å‡º</label>
                <textarea id="comment" rows="3" placeholder="è¾›ã„ã¨ãã«ã“ã®æ­Œè©ã«æ•‘ã‚ã‚Œã¾ã—ãŸ...ãªã©" required></textarea>
            </div>
            <button type="submit" class="submit-btn">æŠ•ç¨¿ã™ã‚‹</button>
        </form>
    </div>

    <div class="playlist-container">
        <h2 class="section-title">å‹‡æ°—ã‚’ãã‚ŒãŸæ›²ãŸã¡</h2>
        <div id="grid" class="grid">
            </div>
    </div>

    <footer>
        åŒã˜ç©ºã®ä¸‹ã§ã€å¿œæ´ã—ã¦ã„ã¾ã™ã€‚<br>
        Â© 2024 Hope Playlist
    </footer>

    <script>
        // åˆæœŸãƒ‡ãƒ¼ã‚¿ï¼ˆã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦è¡¨ç¤ºã™ã‚‹ã‚‚ã®ï¼‰
        const initialSongs = [
            {
                title: "Fight Song",
                artist: "Rachel Platten",
                url: "https://open.spotify.com/track/37f4ItSlgPX81ad2nSyBt2",
                comment: "èª°ãŒãªã‚“ã¨è¨€ãŠã†ã¨ã€ç§ã¯ç§ã®ãƒ•ã‚¡ã‚¤ãƒˆã‚½ãƒ³ã‚°ã‚’æ­Œã„ç¶šã‘ã‚‹ã€‚ãã®æ­Œè©ã«ä½•åº¦ã‚‚æ¶™ã—ã€ç«‹ã¡ä¸ŠãŒã‚‹åŠ›ã‚’ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚"
            },
            {
                title: "Brave",
                artist: "Sara Bareilles",
                url: "https://open.spotify.com/track/6WbYgL0oY5f3pY5rF4q8q6",
                comment: "å£ã«å‡ºã—ã¦è¨€ã†å‹‡æ°—ã€‚è‡ªåˆ†ã®æ®»ã‚’ç ´ã‚‹å‹‡æ°—ã€‚ã“ã®æ›²ã‚’è´ãã¨èƒŒä¸­ã‚’æŠ¼ã•ã‚Œã‚‹æ°—ãŒã—ã¾ã™ã€‚"
            },
            {
                title: "ç¾¤é’",
                artist: "YOASOBI",
                url: "https://open.spotify.com/track/1S8O66h0k70x0x0x0x0", // ãƒ€ãƒŸãƒ¼ãƒªãƒ³ã‚¯
                comment: "å¥½ããªã“ã¨ã‚’ç¶šã‘ã‚‹è‹¦ã—ã•ã¨å–œã³ã€‚é’ã„ç©ºã‚’è¦‹ã‚‹ãŸã³ã«ã“ã®æ›²ã‚’æ€ã„å‡ºã—ã¾ã™ã€‚"
            }
        ];

        // Spotifyã®URLã‹ã‚‰åŸ‹ã‚è¾¼ã¿ç”¨IDã‚’æŠ½å‡ºã™ã‚‹é–¢æ•°
        function getSpotifyId(url) {
            const match = url.match(/track\/([a-zA-Z0-9]+)/);
            return match ? match[1] : null;
        }

        // ã‚«ãƒ¼ãƒ‰ã®HTMLã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
        function createCard(song) {
            const trackId = getSpotifyId(song.url);
            // ãƒˆãƒ©ãƒƒã‚¯IDãŒå–å¾—ã§ãã‚Œã°åŸ‹ã‚è¾¼ã¿ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã€ãªã‘ã‚Œã°ç”»åƒãªã©ã§ä»£ç”¨ã‚‚å¯èƒ½ã ãŒä»Šå›ã¯IDå¿…é ˆå‰æ
            const embedSrc = trackId 
                ? `https://open.spotify.com/embed/track/${trackId}?utm_source=generator&theme=0` 
                : '';

            return `
                <div class="card">
                    <div class="card-iframe-container">
                        ${trackId ? `<iframe src="${embedSrc}" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>` : '<div style="padding:20px; text-align:center; color:#888;">No Preview Available</div>'}
                    </div>
                    <div class="card-content">
                        <div class="card-title">${song.title}</div>
                        <div class="card-artist">${song.artist}</div>
                        <div class="card-comment">${song.comment}</div>
                    </div>
                </div>
            `;
        }

        // ç”»é¢ã«æç”»ã™ã‚‹é–¢æ•°
        function renderSongs() {
            const grid = document.getElementById('grid');
            grid.innerHTML = ''; // ã‚¯ãƒªã‚¢
            
            // LocalStorageã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã€ãªã‘ã‚Œã°åˆæœŸãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
            const storedSongs = JSON.parse(localStorage.getItem('myHopeSongs')) || initialSongs;

            storedSongs.forEach(song => {
                grid.innerHTML += createCard(song);
            });
        }

        // æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ ã®å‡¦ç†
        document.getElementById('songForm').addEventListener('submit', function(e) {
            e.preventDefault(); // ãƒªãƒ­ãƒ¼ãƒ‰é˜²æ­¢

            // å…¥åŠ›å€¤ã‚’å–å¾—
            const title = document.getElementById('title').value;
            const artist = document.getElementById('artist').value;
            const url = document.getElementById('url').value;
            const comment = document.getElementById('comment').value;

            if (!getSpotifyId(url)) {
                alert('Spotifyã®æ­£ã—ã„ãƒˆãƒ©ãƒƒã‚¯URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚\nä¾‹: https://open.spotify.com/track/...');
                return;
            }

            // æ–°ã—ã„æ›²ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
            const newSong = { title, artist, url, comment };

            // ä¿å­˜æ¸ˆã¿ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
            const currentSongs = JSON.parse(localStorage.getItem('myHopeSongs')) || initialSongs;
            
            // æ–°ã—ã„æ›²ã‚’å…ˆé ­ã«è¿½åŠ 
            currentSongs.unshift(newSong);

            // LocalStorageã«ä¿å­˜
            localStorage.setItem('myHopeSongs', JSON.stringify(currentSongs));

            // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦å†æç”»
            this.reset();
            renderSongs();
            alert('æŠ•ç¨¿ã—ã¾ã—ãŸï¼ã‚ãªãŸã®å‹‡æ°—ãŒèª°ã‹ã«å±Šãã¾ã™ã‚ˆã†ã«ã€‚');
        });

        // åˆå›èª­ã¿è¾¼ã¿æ™‚ã«æç”»
        renderSongs();
    </script>
</body>
</html>